<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pipeline_steps package &mdash; AutoProf 1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="autoprofutils package" href="autoprofutils.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            AutoProf
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citing AutoProf</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">LICENSE</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="defaultpipeline.html">Default AutoProf Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">AutoProf Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipelinemanipulation.html">AutoProf Pipeline Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="decisiontrees.html">Decision Trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="extramethods.html">Extra Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting AutoProf</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">autoprof</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="autoprof.html">autoprof package</a></li>
<li class="toctree-l2"><a class="reference internal" href="Pipeline.html">Pipeline module</a></li>
<li class="toctree-l2"><a class="reference internal" href="autoprofutils.html">autoprofutils package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">pipeline_steps package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Axial_Profiles">pipeline_steps.Axial_Profiles module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Axial_Profiles.Axial_Profiles"><code class="docutils literal notranslate"><span class="pre">Axial_Profiles()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Background">pipeline_steps.Background module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Background.Background_Basic"><code class="docutils literal notranslate"><span class="pre">Background_Basic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Background.Background_DilatedSources"><code class="docutils literal notranslate"><span class="pre">Background_DilatedSources()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Background.Background_Mode"><code class="docutils literal notranslate"><span class="pre">Background_Mode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Background.Background_Unsharp"><code class="docutils literal notranslate"><span class="pre">Background_Unsharp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Center">pipeline_steps.Center module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Center.Center_1DGaussian"><code class="docutils literal notranslate"><span class="pre">Center_1DGaussian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Center.Center_2DGaussian"><code class="docutils literal notranslate"><span class="pre">Center_2DGaussian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Center.Center_Forced"><code class="docutils literal notranslate"><span class="pre">Center_Forced()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Center.Center_HillClimb"><code class="docutils literal notranslate"><span class="pre">Center_HillClimb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Center.Center_HillClimb_mean"><code class="docutils literal notranslate"><span class="pre">Center_HillClimb_mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Center.Center_OfMass"><code class="docutils literal notranslate"><span class="pre">Center_OfMass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Center.Center_Peak"><code class="docutils literal notranslate"><span class="pre">Center_Peak()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Check_Fit">pipeline_steps.Check_Fit module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Check_Fit.Check_Fit"><code class="docutils literal notranslate"><span class="pre">Check_Fit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Ellipse_Model">pipeline_steps.Ellipse_Model module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Ellipse_Model.EllipseModel"><code class="docutils literal notranslate"><span class="pre">EllipseModel()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Isophote_Extract">pipeline_steps.Isophote_Extract module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Isophote_Extract.Isophote_Extract"><code class="docutils literal notranslate"><span class="pre">Isophote_Extract()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Isophote_Extract.Isophote_Extract_Forced"><code class="docutils literal notranslate"><span class="pre">Isophote_Extract_Forced()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Isophote_Extract.Isophote_Extract_Photutils"><code class="docutils literal notranslate"><span class="pre">Isophote_Extract_Photutils()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Isophote_Fit">pipeline_steps.Isophote_Fit module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Isophote_Fit.Isophote_Fit_FFT_Robust"><code class="docutils literal notranslate"><span class="pre">Isophote_Fit_FFT_Robust()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Isophote_Fit.Isophote_Fit_FFT_mean"><code class="docutils literal notranslate"><span class="pre">Isophote_Fit_FFT_mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Isophote_Fit.Isophote_Fit_FixedPhase"><code class="docutils literal notranslate"><span class="pre">Isophote_Fit_FixedPhase()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Isophote_Fit.Isophote_Fit_Forced"><code class="docutils literal notranslate"><span class="pre">Isophote_Fit_Forced()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Isophote_Fit.Photutils_Fit"><code class="docutils literal notranslate"><span class="pre">Photutils_Fit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Isophote_Initialize">pipeline_steps.Isophote_Initialize module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Isophote_Initialize.Isophote_Init_Forced"><code class="docutils literal notranslate"><span class="pre">Isophote_Init_Forced()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Isophote_Initialize.Isophote_Initialize"><code class="docutils literal notranslate"><span class="pre">Isophote_Initialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Isophote_Initialize.Isophote_Initialize_mean"><code class="docutils literal notranslate"><span class="pre">Isophote_Initialize_mean()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Mask">pipeline_steps.Mask module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Mask.Bad_Pixel_Mask"><code class="docutils literal notranslate"><span class="pre">Bad_Pixel_Mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Mask.Mask_Segmentation_Map"><code class="docutils literal notranslate"><span class="pre">Mask_Segmentation_Map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Mask.Star_Mask"><code class="docutils literal notranslate"><span class="pre">Star_Mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Mask.Star_Mask_IRAF"><code class="docutils literal notranslate"><span class="pre">Star_Mask_IRAF()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.PSF">pipeline_steps.PSF module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.PSF.PSF_IRAF"><code class="docutils literal notranslate"><span class="pre">PSF_IRAF()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.PSF.PSF_Image"><code class="docutils literal notranslate"><span class="pre">PSF_Image()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.PSF.PSF_StarFind"><code class="docutils literal notranslate"><span class="pre">PSF_StarFind()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.PSF.PSF_deconvolve"><code class="docutils literal notranslate"><span class="pre">PSF_deconvolve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Plotting_Steps">pipeline_steps.Plotting_Steps module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Plotting_Steps.Plot_Galaxy_Image"><code class="docutils literal notranslate"><span class="pre">Plot_Galaxy_Image()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Radial_Profiles">pipeline_steps.Radial_Profiles module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Radial_Profiles.Radial_Profiles"><code class="docutils literal notranslate"><span class="pre">Radial_Profiles()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Slice_Profiles">pipeline_steps.Slice_Profiles module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Slice_Profiles.Slice_Profile"><code class="docutils literal notranslate"><span class="pre">Slice_Profile()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Write_Fi">pipeline_steps.Write_Fi module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Write_Fi.WriteFi"><code class="docutils literal notranslate"><span class="pre">WriteFi()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps.Write_Prof">pipeline_steps.Write_Prof module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#autoprof.pipeline_steps.Write_Prof.WriteProf"><code class="docutils literal notranslate"><span class="pre">WriteProf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-autoprof.pipeline_steps">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AutoProf</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">autoprof</a></li>
      <li class="breadcrumb-item active">pipeline_steps package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pipeline_steps.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pipeline-steps-package">
<h1>pipeline_steps package<a class="headerlink" href="#pipeline-steps-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-autoprof.pipeline_steps.Axial_Profiles">
<span id="pipeline-steps-axial-profiles-module"></span><h2>pipeline_steps.Axial_Profiles module<a class="headerlink" href="#module-autoprof.pipeline_steps.Axial_Profiles" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Axial_Profiles.Axial_Profiles">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Axial_Profiles.</span></span><span class="sig-name descname"><span class="pre">Axial_Profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Axial_Profiles.html#Axial_Profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Axial_Profiles.Axial_Profiles" title="Permalink to this definition"></a></dt>
<dd><p>Extracts SB profiles perpendicular to the major (or minor) axis.</p>
<p>For some applications, such as examining edge on galaxies, it is
beneficial to observe the vertical structure in a disk. This can
be achieved with the Axial Profiles method. It will construct a
series of lines, each one with a starting point on the major axis
of the galaxy and radiating perpendicular from it. The location of
these lines are, by default, geometrically spaced so that they can
gather more light in the fainter outskirts. Along a given line,
and SB profile is extracted, with the distance between points on
the profile also increasing geometrically, allowing more light
collection. The outputted profile is formatted similar to a
regular SB profile, except that there are many SB profiles with
each one having a corresponding distance from the center and
quadrant of the image. A diagnostic image is generated to aid in
identifying where each profile is extracted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_axialprof_pa</strong> (<em>float</em><em>, </em><em>default 0</em>) – user set position angle at which to align the axial profiles
relative to the global position angle+90, in degrees. A common
choice would be “90” which would then sample along the
semi-major axis instead of the semi-minor axis.</p></li>
<li><p><strong>ap_zeropoint</strong> (<em>float</em><em>, </em><em>default 22.5</em>) – Photometric zero point</p></li>
<li><p><strong>ap_samplestyle</strong> (<em>string</em><em>, </em><em>default 'geometric'</em>) – indicate if isophote sampling radii should grow linearly or
geometrically. Can also do geometric sampling at the center and
linear sampling once geometric step size equals linear. Options
are: ‘linear’, ‘geometric’, and ‘geometric-linear’.</p></li>
<li><p><strong>ap_isoaverage_method</strong> (<em>string</em><em>, </em><em>default 'median'</em>) – Select the method used to compute the averafge flux along an
isophote. Choose from ‘mean’, ‘median’, and ‘mode’.  In general,
median is fast and robust to a few outliers. Mode is slow but
robust to more outliers. Mean is fast and accurate in low S/N
regimes where fluxes take on near integer values, but not robust
to outliers. The mean should be used along with a mask to remove
spurious objects such as foreground stars or galaxies, and
should always be used with caution.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘mask’ (optional)</p></li>
<li><p>‘background’</p></li>
<li><p>‘psf fwhm’</p></li>
<li><p>‘center’</p></li>
<li><p>‘prof data’ (optional)</p></li>
<li><p>‘init pa’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) – No results provided as this method writes its own profile</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.Background">
<span id="pipeline-steps-background-module"></span><h2>pipeline_steps.Background module<a class="headerlink" href="#module-autoprof.pipeline_steps.Background" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Background.Background_Basic">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Background.</span></span><span class="sig-name descname"><span class="pre">Background_Basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Background.html#Background_Basic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Background.Background_Basic" title="Permalink to this definition"></a></dt>
<dd><p>Compute the mean flux in the border of an image.</p>
<p>Takes all pixels in a 1/5th border of the image and computes the
mean. To compute the noise in the background level, we simply take
the standard deviation of the flux values. This background
estimation method is only for diagnostic purposes and will be
considerably biased on real astronomical images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_set_background</strong> (<em>float</em><em>, </em><em>default None</em>) – User provided background value in flux</p></li>
<li><p><strong>ap_set_background_noise</strong> (<em>float</em><em>, </em><em>default None</em>) – User provided background noise level in flux</p></li>
<li><p><strong>ap_background_speedup</strong> (<em>int</em><em>, </em><em>default 1</em>) – For large images, this can be millions of pixels, which is not
really needed to achieve an accurate background level, the user
can provide a positive integer factor by which to reduce the
number of pixels used in the calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;background&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># flux value representing the background level (float)</span>
 <span class="s1">&#39;background noise&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># measure of scatter around the background level (float)</span>
 <span class="s1">&#39;background uncertainty&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># optional, uncertainty on background level (float)</span>
 <span class="s1">&#39;auxfile background&#39;</span><span class="p">:</span> <span class="c1"># optional, message for aux file to record background level (string)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Background.Background_DilatedSources">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Background.</span></span><span class="sig-name descname"><span class="pre">Background_DilatedSources</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Background.html#Background_DilatedSources"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Background.Background_DilatedSources" title="Permalink to this definition"></a></dt>
<dd><p>Compute the median flux after removing bright sources.</p>
<p>Compute a global background value for an image. Performed by
identifying pixels which are beyond 3 sigma above the average
signal and masking them, also further masking a border
of 20 pixels around the initial masked pixels. Returns a
dictionary of parameters describing the background level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_set_background</strong> (<em>float</em><em>, </em><em>default None</em>) – User provided background value in flux</p></li>
<li><p><strong>ap_set_background_noise</strong> (<em>float</em><em>, </em><em>default None</em>) – User provided background noise level in flux</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;background&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># flux value representing the background level (float)</span>
 <span class="s1">&#39;background noise&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># measure of scatter around the background level (float)</span>
 <span class="s1">&#39;background uncertainty&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># optional, uncertainty on background level (float)</span>
 <span class="s1">&#39;auxfile background&#39;</span><span class="p">:</span> <span class="c1"># optional, message for aux file to record background level (string)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Background.Background_Mode">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Background.</span></span><span class="sig-name descname"><span class="pre">Background_Mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Background.html#Background_Mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Background.Background_Mode" title="Permalink to this definition"></a></dt>
<dd><p>Compute the mode flux in the border of an image.</p>
<p>Takes all pixels in a 1/5th border of the image. Applies a
Gaussian smoothing length of log10(sqrt(N)) where N is the number
of sampled pixels. The peak of the smoothed distribution is found
using Nelder-Mead optimization. To compute the noise in the
background level, we take all flux values below the fitted
background level and compute the 31.73 - 100 percent range. This
corresponds to the lower 1sigma, we do not use the upper 1sigma as
it is contaminated by faint sources. In truth the lower 1sigma is
contaminated as well, though to a lesser extent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_set_background</strong> (<em>float</em><em>, </em><em>default None</em>) – User provided background value in flux</p></li>
<li><p><strong>ap_set_background_noise</strong> (<em>float</em><em>, </em><em>default None</em>) – User provided background noise level in flux</p></li>
<li><p><strong>ap_background_speedup</strong> (<em>int</em><em>, </em><em>default 1</em>) – For large images, this can be millions of pixels, which is not
really needed to achieve an accurate background level, the user
can provide a positive integer factor by which to reduce the
number of pixels used in the calculation.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For best results, use a segmentation mask to remove sources.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;background&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># flux value representing the background level (float)</span>
 <span class="s1">&#39;background noise&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># measure of scatter around the background level (float)</span>
 <span class="s1">&#39;background uncertainty&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># optional, uncertainty on background level (float)</span>
 <span class="s1">&#39;auxfile background&#39;</span><span class="p">:</span> <span class="c1"># optional, message for aux file to record background level (string)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Background.Background_Unsharp">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Background.</span></span><span class="sig-name descname"><span class="pre">Background_Unsharp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Background.html#Background_Unsharp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Background.Background_Unsharp" title="Permalink to this definition"></a></dt>
<dd><p>creates a 2D background level using low order FFT coefficients.</p>
<p>Takes the 2D FFT of an image and sets all coefficients above 3 to
zero. This creates a very smooth image which can be used as a
variable background level.  This can then be subtracted from
images to remove large bright sources, such as a nearby BGC or
bright star. However, this background estimation method will
likely also heavily bias flux value. Thus it can reasonably be
used to isolate a galaxy with a large overlapping partner for the
sake of fitting isophotes, but the extracted flux profile will be
unreliable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ap_background_unsharp_lowpass</strong> (<em>int</em><em>, </em><em>default 3</em>) – User provided FFT coefficient cutoff for constructing unsharp image.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;background&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># flux image representing the variable background level (ndarray)</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.Center">
<span id="pipeline-steps-center-module"></span><h2>pipeline_steps.Center module<a class="headerlink" href="#module-autoprof.pipeline_steps.Center" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Center.Center_1DGaussian">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Center.</span></span><span class="sig-name descname"><span class="pre">Center_1DGaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Center.html#Center_1DGaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Center.Center_1DGaussian" title="Permalink to this definition"></a></dt>
<dd><p>Find galaxy center with many 1D gaussian fits to the image..</p>
<p>Compute the pixel location of the galaxy center using a photutils
method.  Looking at 100 seeing lengths around the center of the
image (images should already be mostly centered), finds the galaxy
center by fitting several 1d Gaussians.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_guess_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided starting point for center fitting. Center should
be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
<li><p><strong>ap_set_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided fixed center for rest of calculations. Center
should be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
<li><p><strong>ap_centeringring</strong> (<em>int</em><em>, </em><em>default 50</em>) – Size of ring to use when finding galaxy center, in units of
PSF. Larger rings will give the 1D fits more data to work with
and allow for the starting position to be further from the true
galaxy center.  Smaller rings will include fewer spurious
objects, and can stop the 1D fits from being distracted by
larger nearby objects/galaxies.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘psf fwhm’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># x coordinate of the center (pix)</span>
            <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">},</span> <span class="c1"># y coordinate of the center (pix)</span>

 <span class="s1">&#39;auxfile center&#39;</span><span class="p">:</span> <span class="c1"># optional, message for aux file to record galaxy center (string)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Center.Center_2DGaussian">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Center.</span></span><span class="sig-name descname"><span class="pre">Center_2DGaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Center.html#Center_2DGaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Center.Center_2DGaussian" title="Permalink to this definition"></a></dt>
<dd><p>Find galaxy center with a 2D gaussian fit to the image..</p>
<p>Compute the pixel location of the galaxy center by fitting a 2d
Gaussian as implimented by the photutils package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_guess_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided starting point for center fitting. Center should
be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
<li><p><strong>ap_set_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided fixed center for rest of calculations. Center
should be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
<li><p><strong>ap_centeringring</strong> (<em>int</em><em>, </em><em>default 50</em>) – Size of ring to use when finding galaxy center, in units of
PSF. Larger rings will give the 2D fit more data to work with
and allow for the starting position to be further from the true
galaxy center.  Smaller rings will include fewer spurious
objects, and can stop the 2D fit from being distracted by larger
nearby objects/galaxies.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘psf fwhm’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># x coordinate of the center (pix)</span>
            <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">},</span> <span class="c1"># y coordinate of the center (pix)</span>

 <span class="s1">&#39;auxfile center&#39;</span><span class="p">:</span> <span class="c1"># optional, message for aux file to record galaxy center (string)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Center.Center_Forced">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Center.</span></span><span class="sig-name descname"><span class="pre">Center_Forced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Center.html#Center_Forced"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Center.Center_Forced" title="Permalink to this definition"></a></dt>
<dd><p>Extracts previously fit center coordinates.</p>
<p>Extracts the center coordinates from an aux file for a previous
AutoProf fit. Can instead simply be given a set center value, just
like other centering methods. A given center will override teh
fitted aux file center.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_guess_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided starting point for center fitting. Center should
be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
<li><p><strong>ap_set_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided fixed center for rest of calculations. Center
should be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
<li><p><strong>ap_forcing_profile</strong> (<em>string</em><em>, </em><em>default None</em>) – (required for forced photometry) file path to .prof file
providing forced photometry PA and ellip values to apply to
<em>ap_image_file</em>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># x coordinate of the center (pix)</span>
            <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">},</span> <span class="c1"># y coordinate of the center (pix)</span>

 <span class="s1">&#39;auxfile center&#39;</span><span class="p">:</span> <span class="c1"># optional, message for aux file to record galaxy center (string)</span>
 <span class="s1">&#39;auxfile centeral sb&#39;</span><span class="p">:</span> <span class="c1"># optional, central surface brightness value (float)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Center.Center_HillClimb">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Center.</span></span><span class="sig-name descname"><span class="pre">Center_HillClimb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Center.html#Center_HillClimb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Center.Center_HillClimb" title="Permalink to this definition"></a></dt>
<dd><p>Follow locally increasing brightness (robust to PSF size objects) to find peak.</p>
<p>Using 10 circular isophotes out to 10 times the PSF length, the first FFT coefficient
phases are averaged to find the direction of increasing flux. Flux values are sampled
along this direction and a quadratic fit gives the maximum. This is iteratively
repeated until the step size becomes very small.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_guess_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided starting point for center fitting. Center should
be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
<li><p><strong>ap_set_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided fixed center for rest of calculations. Center
should be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
<li><p><strong>ap_centeringring</strong> (<em>int</em><em>, </em><em>default 10</em>) – Size of ring to use when finding galaxy center, in units of
PSF. Larger rings will be robust to features (i.e., foreground
stars), while smaller rings may be needed for small galaxies.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘psf fwhm’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># x coordinate of the center (pix)</span>
            <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">},</span> <span class="c1"># y coordinate of the center (pix)</span>

 <span class="s1">&#39;auxfile center&#39;</span><span class="p">:</span> <span class="c1"># optional, message for aux file to record galaxy center (string)</span>
 <span class="s1">&#39;auxfile centeral sb&#39;</span><span class="p">:</span> <span class="c1"># optional, central surface brightness value (float)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Center.Center_HillClimb_mean">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Center.</span></span><span class="sig-name descname"><span class="pre">Center_HillClimb_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Center.html#Center_HillClimb_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Center.Center_HillClimb_mean" title="Permalink to this definition"></a></dt>
<dd><p>Follow locally increasing brightness (robust to PSF size objects) to find peak.</p>
<p>Using 10 circular isophotes out to 10 times the PSF length, the
first FFT coefficient phases are averaged to find the direction of
increasing flux. Flux values are sampled along this direction and
a quadratic fit gives the maximum. This is iteratively repeated
until the step size becomes very small. This function is identical
to <code class="xref py py-func docutils literal notranslate"><span class="pre">Center_HillClimb()</span></code> except that all
averages/scatters are mean/std based instead of median/iqr based.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_guess_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided starting point for center fitting. Center should
be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
<li><p><strong>ap_set_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided fixed center for rest of calculations. Center
should be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
<li><p><strong>ap_centeringring</strong> (<em>int</em><em>, </em><em>default 10</em>) – Size of ring to use when finding galaxy center, in units of
PSF. Larger rings will be robust to features (i.e., foreground
stars), while smaller rings may be needed for small galaxies.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘psf fwhm’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># x coordinate of the center (pix)</span>
            <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">},</span> <span class="c1"># y coordinate of the center (pix)</span>

 <span class="s1">&#39;auxfile center&#39;</span><span class="p">:</span> <span class="c1"># optional, message for aux file to record galaxy center (string)</span>
 <span class="s1">&#39;auxfile centeral sb&#39;</span><span class="p">:</span> <span class="c1"># optional, central surface brightness value (float)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Center.Center_OfMass">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Center.</span></span><span class="sig-name descname"><span class="pre">Center_OfMass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Center.html#Center_OfMass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Center.Center_OfMass" title="Permalink to this definition"></a></dt>
<dd><p>Find the light weighted galaxy center.</p>
<p>Iteratively computes the light weighted centroid within a window,
moves to the new center and computes the light weighted centroid
again.  The size of the search area is 10PSF by default. The
iterative process will continue until the center is updated by
less than 1/10th of the PSF size or when too mny iterations have
been reached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_guess_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided starting point for center fitting. Center should
be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
<li><p><strong>ap_set_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided fixed center for rest of calculations. Center
should be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
<li><p><strong>ap_centeringring</strong> (<em>int</em><em>, </em><em>default 10</em>) – Size of ring to use when finding galaxy center, in units of
PSF. Larger rings will allow for the starting position to be
further from the true galaxy center.  Smaller rings will include
fewer spurious objects, and can stop the centroid from being
distracted by larger nearby objects/galaxies.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘psf fwhm’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># x coordinate of the center (pix)</span>
            <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">},</span> <span class="c1"># y coordinate of the center (pix)</span>

 <span class="s1">&#39;auxfile center&#39;</span><span class="p">:</span> <span class="c1"># optional, message for aux file to record galaxy center (string)</span>
 <span class="s1">&#39;auxfile centeral sb&#39;</span><span class="p">:</span> <span class="c1"># optional, central surface brightness value (float)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Center.Center_Peak">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Center.</span></span><span class="sig-name descname"><span class="pre">Center_Peak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Center.html#Center_Peak"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Center.Center_Peak" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.Check_Fit">
<span id="pipeline-steps-check-fit-module"></span><h2>pipeline_steps.Check_Fit module<a class="headerlink" href="#module-autoprof.pipeline_steps.Check_Fit" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Check_Fit.Check_Fit">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Check_Fit.</span></span><span class="sig-name descname"><span class="pre">Check_Fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Check_Fit.html#Check_Fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Check_Fit.Check_Fit" title="Permalink to this definition"></a></dt>
<dd><p>Check for cases of failed isophote fits.</p>
<p>A variety of check methods are applied to ensure that the fit has
converged to a reasonable solution.  If a fit passes all of these
checks then it is typically an acceptable fit.  However if it
fails one or more of the checks then the fit likely either failed
or the galaxy has strong non-axisymmetric features (and the fit
itself may be acceptable).</p>
<p>One check samples the fitted isophotes and looks for cases with
high variability of flux values along the isophote.  This is done
by comparing the interquartile range to the median flux, if the
interquartile range is larger then that isophote is flagged.  If
enough isophotes are flagged then the fit may have failed.</p>
<p>A second check operates similarly, checking the second and fourth
FFT coefficient amplitudes relative to the median flux.  If many
of the isophotes have large FFT coefficients, or if a few of the
isophotes have very large FFT coefficients then the fit is flagged
as potentially failed.</p>
<p>A third check is similar to the first, except that it compares the
interquartile range from the fitted isophotes to those using just
the global position angle and ellipticity values.</p>
<p>A fourth check uses the first FFT coefficient to detect if the
light is biased to one side of the galaxy. Typically this
indicated either a failed center, or the galaxy has been disturbed
and is not lopsided.</p>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘center’</p></li>
<li><p>‘init ellip’</p></li>
<li><p>‘init pa’</p></li>
<li><p>‘fit R’ (optional)</p></li>
<li><p>‘fit ellip’ (optional)</p></li>
<li><p>‘fit pa’ (optional)</p></li>
<li><p>‘prof data’ (optional)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;checkfit&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;isophote variability&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># True if the test was passed, False if the test failed (bool)</span>
              <span class="s1">&#39;FFT coefficients&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># True if the test was passed, False if the test failed (bool)</span>
              <span class="s1">&#39;initial fit compare&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># True if the test was passed, False if the test failed (bool)</span>
              <span class="s1">&#39;Light symmetry&#39;</span><span class="p">:</span> <span class="p">},</span> <span class="c1"># True if the test was passed, False if the test failed (bool)</span>

 <span class="s1">&#39;auxfile checkfit isophote variability&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># optional aux file message for pass/fail of test (string)</span>
 <span class="s1">&#39;auxfile checkfit FFT coefficients&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># optional aux file message for pass/fail of test (string)</span>
 <span class="s1">&#39;auxfile checkfit initial fit compare&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># optional aux file message for pass/fail of test (string)</span>
 <span class="s1">&#39;auxfile checkfit Light symmetry&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># optional aux file message for pass/fail of test (string)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.Ellipse_Model">
<span id="pipeline-steps-ellipse-model-module"></span><h2>pipeline_steps.Ellipse_Model module<a class="headerlink" href="#module-autoprof.pipeline_steps.Ellipse_Model" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Ellipse_Model.EllipseModel">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Ellipse_Model.</span></span><span class="sig-name descname"><span class="pre">EllipseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Ellipse_Model.html#EllipseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Ellipse_Model.EllipseModel" title="Permalink to this definition"></a></dt>
<dd><p>Construct a smooth model image of the galaxy with fixed PA/elliptiicty.</p>
<p>Constructs a 2D model image of the galaxy based on the extracted
surface brightness profile and the global ellipticity and position
angle values. First the image is transformed by rotating and
stretching until the global ellipse fit has been transformed into
a circle.  The radial distance of every pixel from the galaxy
center is then used on an interpolated SB profile to determine the
corresponding SB value. The SB values are applied and converted
from mag/arcsec^2 to flux units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_zeropoint</strong> (<em>float</em><em>, </em><em>default 22.5</em>) – Photometric zero point</p></li>
<li><p><strong>ap_ellipsemodel_resolution</strong> (<em>float</em><em>, </em><em>default 1</em>) – scale factor for the ellipse model resolution. Above 1 increases
the precision of the ellipse model (and computation time),
between 0 and 1 decreases the resolution (and computation
time). Note that the ellipse model resolution is defined
logarithmically, so the center will always be more resolved</p></li>
<li><p><strong>ap_ellipsemodel_replacemaskedpixels</strong> (<em>bool</em><em>, </em><em>default False</em>) – If True, a new galaxy image will be generated with masked pixels
replaced by the ellipse model values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;ellipse model&#39;</span><span class="p">:</span> <span class="c1"># 2d image with flux values for smooth model of galaxy</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.Isophote_Extract">
<span id="pipeline-steps-isophote-extract-module"></span><h2>pipeline_steps.Isophote_Extract module<a class="headerlink" href="#module-autoprof.pipeline_steps.Isophote_Extract" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Isophote_Extract.Isophote_Extract">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Isophote_Extract.</span></span><span class="sig-name descname"><span class="pre">Isophote_Extract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Isophote_Extract.html#Isophote_Extract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Isophote_Extract.Isophote_Extract" title="Permalink to this definition"></a></dt>
<dd><p>General method for extracting SB profiles.</p>
<p>The default SB profile extraction method is highly
flexible, allowing users to test a variety of techniques on their data
to determine the most robust. The user may specify a variety of
sampling arguments for the photometry extraction.  For example, a
start or end radius in pixels, or whether to sample geometrically or
linearly in radius.  Geometric sampling is the default as it is
faster.  Once the sampling profile of semi-major axis values has been
chosen, the function interpolates (spline) the position angle and
ellipticity profiles at the requested values.  For any sampling beyond
the outer radius from the <em>Isophotal Fitting</em> step, a constant value
is used.  Within 1 PSF, a circular isophote is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_zeropoint</strong> (<em>float</em><em>, </em><em>default 22.5</em>) – Photometric zero point. For converting flux to mag units.</p></li>
<li><p><strong>ap_fluxunits</strong> (<em>str</em><em>, </em><em>default &quot;mag&quot;</em>) – units for outputted photometry. Can either be “mag” for log
units, or “intensity” for linear units.</p></li>
<li><p><strong>ap_samplegeometricscale</strong> (<em>float</em><em>, </em><em>default 0.1</em>) – growth scale for isophotes when sampling for the final output
profile.  Used when sampling geometrically. By default, each
isophote is 10% further than the last.</p></li>
<li><p><strong>ap_samplelinearscale</strong> (<em>float</em><em>, </em><em>default None</em>) – growth scale (in pixels) for isophotes when sampling for the
final output profile. Used when sampling linearly. Default is 1
PSF length.</p></li>
<li><p><strong>ap_samplestyle</strong> (<em>string</em><em>, </em><em>default 'geometric'</em>) – indicate if isophote sampling radii should grow linearly or
geometrically. Can also do geometric sampling at the center and
linear sampling once geometric step size equals linear. Options
are: ‘linear’, ‘geometric’, ‘geometric-linear’</p></li>
<li><p><strong>ap_sampleinitR</strong> (<em>float</em><em>, </em><em>default None</em>) – Starting radius (in pixels) for isophote sampling from the
image. Note that a starting radius of zero is not
advised. Default is 1 pixel or 1PSF, whichever is smaller.</p></li>
<li><p><strong>ap_sampleendR</strong> (<em>float</em><em>, </em><em>default None</em>) – End radius (in pixels) for isophote sampling from the
image. Default is 3 times the fit radius, also see
<em>ap_extractfull</em>.</p></li>
<li><p><strong>ap_isoband_start</strong> (<em>float</em><em>, </em><em>default 2</em>) – The noise level at which to begin sampling a band of pixels to
compute SB instead of sampling a line of pixels near the
isophote in units of pixel flux noise. Will never initiate band
averaging if the band width is less than half a pixel</p></li>
<li><p><strong>ap_isoband_width</strong> (<em>float</em><em>, </em><em>default 0.025</em>) – The relative size of the isophote bands to sample. flux values
will be sampled at +- <em>ap_isoband_width</em> *R for each radius.</p></li>
<li><p><strong>ap_isoband_fixed</strong> (<em>bool</em><em>, </em><em>default False</em>) – Use a fixed width for the size of the isobands, the width is set
by <em>ap_isoband_width</em> which now has units of pixels, the default
is 0.5 such that the full band has a width of 1 pixel.</p></li>
<li><p><strong>ap_truncate_evaluation</strong> (<em>bool</em><em>, </em><em>default False</em>) – Stop evaluating new isophotes once two negative flux isophotes
have been recorded, presumed to have reached the end of the
profile.</p></li>
<li><p><strong>ap_extractfull</strong> (<em>bool</em><em>, </em><em>default False</em>) – Tells AutoProf to extend the isophotal solution to the edge of
the image. Will be overridden by <em>ap_truncate_evaluation</em>.</p></li>
<li><p><strong>ap_iso_interpolate_start</strong> (<em>float</em><em>, </em><em>default 5</em>) – Use a Lanczos interpolation for isophotes with semi-major axis
less than this number times the PSF.</p></li>
<li><p><strong>ap_iso_interpolate_method</strong> (<em>string</em><em>, </em><em>default 'lanczos'</em>) – Select method for flux interpolation on image, options are
‘lanczos’ and ‘bicubic’. Default is ‘lanczos’ with a window size
of 3.</p></li>
<li><p><strong>ap_iso_interpolate_window</strong> (<em>int</em><em>, </em><em>default 3</em>) – Window size for Lanczos interpolation, default is 3, meaning 3
pixels on either side of the sample point are used for
interpolation.</p></li>
<li><p><strong>ap_isoaverage_method</strong> (<em>string</em><em>, </em><em>default 'median'</em>) – Select the method used to compute the averafge flux along an
isophote. Choose from ‘mean’, ‘median’, and ‘mode’.  In general,
median is fast and robust to a few outliers. Mode is slow but
robust to more outliers. Mean is fast and accurate in low S/N
regimes where fluxes take on near integer values, but not robust
to outliers. The mean should be used along with a mask to remove
spurious objects such as foreground stars or galaxies, and
should always be used with caution.</p></li>
<li><p><strong>ap_isoclip</strong> (<em>bool</em><em>, </em><em>default False</em>) – Perform sigma clipping along extracted isophotes. Removes flux
samples from an isophote that deviate significantly from the
median. Several iterations of sigma clipping are performed until
convergence or <em>ap_isoclip_iterations</em> iterations are
reached. Sigma clipping is a useful substitute for masking
objects, though careful masking is better. Also an aggressive
sigma clip may bias results.</p></li>
<li><p><strong>ap_isoclip_iterations</strong> (<em>int</em><em>, </em><em>default None</em>) – Maximum number of sigma clipping iterations to perform. The
default is infinity, so the sigma clipping procedure repeats
until convergence</p></li>
<li><p><strong>ap_isoclip_nsigma</strong> (<em>float</em><em>, </em><em>default 5</em>) – Number of sigma above median to apply clipping. All values above
(median + <em>ap_isoclip_nsigma</em> x sigma) are removed from the
isophote.</p></li>
<li><p><strong>ap_iso_measurecoefs</strong> (<em>tuple</em><em>, </em><em>default None</em>) – tuple indicating which fourier modes to extract along fitted
isophotes. Most common is (4,), which identifies boxy/disky
isophotes. Also common is (1,3), which identifies lopsided
galaxies. The outputted values are computed as a_i =
imag(F_i)/abs(F_0) and b_i = real(F_i)/abs(F_0) where F_i is a
fourier coefficient. Not activated by default as it adds to
computation time.</p></li>
<li><p><strong>ap_plot_sbprof_ylim</strong> (<em>tuple</em><em>, </em><em>default None</em>) – Tuple with axes limits for the y-axis in the SB profile
diagnostic plot. Be careful when using intensity units
since this will change the ideal axis limits.</p></li>
<li><p><strong>ap_plot_sbprof_xlim</strong> (<em>tuple</em><em>, </em><em>default None</em>) – Tuple with axes limits for the x-axis in the SB profile
diagnostic plot.</p></li>
<li><p><strong>ap_plot_sbprof_set_errscale</strong> (<em>float</em><em>, </em><em>default None</em>) – Float value by which to scale errorbars on the SB profile
this makes them more visible in cases where the statistical
errors are very small.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘psf fwhm’</p></li>
<li><p>‘center’</p></li>
<li><p>‘init ellip’</p></li>
<li><p>‘init pa’</p></li>
<li><p>‘fit R’</p></li>
<li><p>‘fit ellip’</p></li>
<li><p>‘fit pa’</p></li>
<li><p>‘fit ellip_err’ (optional)</p></li>
<li><p>‘fit pa_err’ (optional)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;prof header&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># List object with strings giving the items in the header of the final SB profile (list)</span>
 <span class="s1">&#39;prof units&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># dict object that links header strings to units (given as strings) for each variable (dict)</span>
 <span class="s1">&#39;prof data&#39;</span><span class="p">:</span> <span class="c1"># dict object linking header strings to list objects containing the rows for a given variable (dict)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Isophote_Extract.Isophote_Extract_Forced">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Isophote_Extract.</span></span><span class="sig-name descname"><span class="pre">Isophote_Extract_Forced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Isophote_Extract.html#Isophote_Extract_Forced"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Isophote_Extract.Isophote_Extract_Forced" title="Permalink to this definition"></a></dt>
<dd><p>Method for extracting SB profiles that have been set by forced photometry.</p>
<p>This is nearly identical to the general isophote extraction
method, except that it does not choose which radii to sample the
profile, instead it takes the radii, PA, and ellipticities as
given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_zeropoint</strong> (<em>float</em><em>, </em><em>default 22.5</em>) – Photometric zero point. For converting flux to mag units.</p></li>
<li><p><strong>ap_fluxunits</strong> (<em>str</em><em>, </em><em>default &quot;mag&quot;</em>) – units for outputted photometry. Can either be “mag” for log
units, or “intensity” for linear units.</p></li>
<li><p><strong>ap_isoband_start</strong> (<em>float</em><em>, </em><em>default 2</em>) – The noise level at which to begin sampling a band of pixels to
compute SB instead of sampling a line of pixels near the
isophote in units of pixel flux noise. Will never initiate band
averaging if the band width is less than half a pixel</p></li>
<li><p><strong>ap_isoband_width</strong> (<em>float</em><em>, </em><em>default 0.025</em>) – The relative size of the isophote bands to sample. flux values
will be sampled at +- <em>ap_isoband_width</em> *R for each radius.</p></li>
<li><p><strong>ap_isoband_fixed</strong> (<em>bool</em><em>, </em><em>default False</em>) – Use a fixed width for the size of the isobands, the width is set
by <em>ap_isoband_width</em> which now has units of pixels, the default
is 0.5 such that the full band has a width of 1 pixel.</p></li>
<li><p><strong>ap_truncate_evaluation</strong> (<em>bool</em><em>, </em><em>default False</em>) – Stop evaluating new isophotes once two negative flux isophotes
have been recorded, presumed to have reached the end of the
profile.</p></li>
<li><p><strong>ap_iso_interpolate_start</strong> (<em>float</em><em>, </em><em>default 5</em>) – Use a Lanczos interpolation for isophotes with semi-major axis
less than this number times the PSF.</p></li>
<li><p><strong>ap_iso_interpolate_method</strong> (<em>string</em><em>, </em><em>default 'lanczos'</em>) – Select method for flux interpolation on image, options are
‘lanczos’ and ‘bicubic’. Default is ‘lanczos’ with a window size
of 3.</p></li>
<li><p><strong>ap_iso_interpolate_window</strong> (<em>int</em><em>, </em><em>default 3</em>) – Window size for Lanczos interpolation, default is 3, meaning 3
pixels on either side of the sample point are used for
interpolation.</p></li>
<li><p><strong>ap_isoaverage_method</strong> (<em>string</em><em>, </em><em>default 'median'</em>) – Select the method used to compute the averafge flux along an
isophote. Choose from ‘mean’, ‘median’, and ‘mode’.  In general,
median is fast and robust to a few outliers. Mode is slow but
robust to more outliers. Mean is fast and accurate in low S/N
regimes where fluxes take on near integer values, but not robust
to outliers. The mean should be used along with a mask to remove
spurious objects such as foreground stars or galaxies, and
should always be used with caution.</p></li>
<li><p><strong>ap_isoclip</strong> (<em>bool</em><em>, </em><em>default False</em>) – Perform sigma clipping along extracted isophotes. Removes flux
samples from an isophote that deviate significantly from the
median. Several iterations of sigma clipping are performed until
convergence or <em>ap_isoclip_iterations</em> iterations are
reached. Sigma clipping is a useful substitute for masking
objects, though careful masking is better. Also an aggressive
sigma clip may bias results.</p></li>
<li><p><strong>ap_isoclip_iterations</strong> (<em>int</em><em>, </em><em>default None</em>) – Maximum number of sigma clipping iterations to perform. The
default is infinity, so the sigma clipping procedure repeats
until convergence</p></li>
<li><p><strong>ap_isoclip_nsigma</strong> (<em>float</em><em>, </em><em>default 5</em>) – Number of sigma above median to apply clipping. All values above
(median + <em>ap_isoclip_nsigma</em> x sigma) are removed from the
isophote.</p></li>
<li><p><strong>ap_iso_measurecoefs</strong> (<em>tuple</em><em>, </em><em>default None</em>) – tuple indicating which fourier modes to extract along fitted
isophotes. Most common is (4,), which identifies boxy/disky
isophotes. Also common is (1,3), which identifies lopsided
galaxies. The outputted values are computed as a_i =
imag(F_i)/abs(F_0) and b_i = real(F_i)/abs(F_0) where F_i is a
fourier coefficient. Not activated by default as it adds to
computation time.</p></li>
<li><p><strong>ap_plot_sbprof_ylim</strong> (<em>tuple</em><em>, </em><em>default None</em>) – Tuple with axes limits for the y-axis in the SB profile
diagnostic plot. Be careful when using intensity units
since this will change the ideal axis limits.</p></li>
<li><p><strong>ap_plot_sbprof_xlim</strong> (<em>tuple</em><em>, </em><em>default None</em>) – Tuple with axes limits for the x-axis in the SB profile
diagnostic plot.</p></li>
<li><p><strong>ap_plot_sbprof_set_errscale</strong> (<em>float</em><em>, </em><em>default None</em>) – Float value by which to scale errorbars on the SB profile
this makes them more visible in cases where the statistical
errors are very small.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘psf fwhm’</p></li>
<li><p>‘center’</p></li>
<li><p>‘init ellip’</p></li>
<li><p>‘init pa’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;prof header&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># List object with strings giving the items in the header of the final SB profile (list)</span>
 <span class="s1">&#39;prof units&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># dict object that links header strings to units (given as strings) for each variable (dict)</span>
 <span class="s1">&#39;prof data&#39;</span><span class="p">:</span> <span class="c1"># dict object linking header strings to list objects containing the rows for a given variable (dict)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Isophote_Extract.Isophote_Extract_Photutils">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Isophote_Extract.</span></span><span class="sig-name descname"><span class="pre">Isophote_Extract_Photutils</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Isophote_Extract.html#Isophote_Extract_Photutils"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Isophote_Extract.Isophote_Extract_Photutils" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper of photutils method for extracting SB profiles.</p>
<p>This simply gives users access to the photutils isophote
extraction methods. The one exception is that SB values are taken
as the median instead of the mean, as recomended in the photutils
documentation. See: <a class="reference external" href="https://photutils.readthedocs.io/en/stable/isophote.html">photutils</a> for
more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_zeropoint</strong> (<em>float</em><em>, </em><em>default 22.5</em>) – Photometric zero point. For converting flux to mag units.</p></li>
<li><p><strong>ap_fluxunits</strong> (<em>str</em><em>, </em><em>default &quot;mag&quot;</em>) – units for outputted photometry. Can either be “mag” for log
units, or “intensity” for linear units.</p></li>
<li><p><strong>ap_plot_sbprof_ylim</strong> (<em>tuple</em><em>, </em><em>default None</em>) – Tuple with axes limits for the y-axis in the SB profile
diagnostic plot. Be careful when using intensity units
since this will change the ideal axis limits.</p></li>
<li><p><strong>ap_plot_sbprof_xlim</strong> (<em>tuple</em><em>, </em><em>default None</em>) – Tuple with axes limits for the x-axis in the SB profile
diagnostic plot.</p></li>
<li><p><strong>ap_plot_sbprof_set_errscale</strong> (<em>float</em><em>, </em><em>default None</em>) – Float value by which to scale errorbars on the SB profile
this makes them more visible in cases where the statistical
errors are very small.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘psf fwhm’</p></li>
<li><p>‘center’</p></li>
<li><p>‘init R’ (optional)</p></li>
<li><p>‘init ellip’ (optional)</p></li>
<li><p>‘init pa’ (optional)</p></li>
<li><p>‘fit R’ (optional)</p></li>
<li><p>‘fit ellip’ (optional)</p></li>
<li><p>‘fit pa’ (optional)</p></li>
<li><p>‘fit photutils isolist’ (optional)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;prof header&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># List object with strings giving the items in the header of the final SB profile (list)</span>
 <span class="s1">&#39;prof units&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># dict object that links header strings to units (given as strings) for each variable (dict)</span>
 <span class="s1">&#39;prof data&#39;</span><span class="p">:</span> <span class="c1"># dict object linking header strings to list objects containing the rows for a given variable (dict)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.Isophote_Fit">
<span id="pipeline-steps-isophote-fit-module"></span><h2>pipeline_steps.Isophote_Fit module<a class="headerlink" href="#module-autoprof.pipeline_steps.Isophote_Fit" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Isophote_Fit.Isophote_Fit_FFT_Robust">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Isophote_Fit.</span></span><span class="sig-name descname"><span class="pre">Isophote_Fit_FFT_Robust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Isophote_Fit.html#Isophote_Fit_FFT_Robust"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Isophote_Fit.Isophote_Fit_FFT_Robust" title="Permalink to this definition"></a></dt>
<dd><p>Fit elliptical isophotes to a galaxy image using FFT coefficients and regularization.</p>
<p>The isophotal fitting routine simultaneously optimizes a
collection of elliptical isophotes by minimizing the 2nd FFT
coefficient power, regularized for robustness. A series of
isophotes are constructed which grow geometrically until they
begin to reach the background level.  Then the algorithm
iteratively updates the position angle and ellipticity of each
isophote individually for many rounds.  Each round updates every
isophote in a random order.  Each round cycles between three
options: optimizing position angle, ellipticity, or both.  To
optimize the parameters, 5 values (pa, ellip, or both) are
randomly sampled and the “loss” is computed.  The loss is a
combination of the relative amplitude of the second FFT
coefficient (compared to the median flux), and a regularization
term.  The regularization term penalizes adjacent isophotes for
having different position angle or ellipticity (using the l1
norm).  Thus, all the isophotes are coupled and tend to fit
smoothly varying isophotes.  When the optimization has completed
three rounds without any isophotes updating, the profile is
assumed to have converged.</p>
<p>An uncertainty for each ellipticity and position angle value is
determined by repeatedly re-optimizing each ellipse with slight
adjustments to it’s semi-major axis length (+- 5%). The standard
deviation of the PA/ellipticity after repeated fitting gives the
uncertainty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_scale</strong> (<em>float</em><em>, </em><em>default 0.2</em>) – growth scale when fitting isophotes, not the same as
<em>ap_sample—scale</em>.</p></li>
<li><p><strong>ap_fit_limit</strong> (<em>float</em><em>, </em><em>default 2</em>) – noise level out to which to extend the fit in units of pixel
background noise level. Default is 2, smaller values will end
fitting further out in the galaxy image.</p></li>
<li><p><strong>ap_regularize_scale</strong> (<em>float</em><em>, </em><em>default 1</em>) – scale factor to apply to regularization coupling factor between
isophotes.  Default of 1, larger values make smoother fits,
smaller values give more chaotic fits.</p></li>
<li><p><strong>ap_isofit_robustclip</strong> (<em>float</em><em>, </em><em>default 0.15</em>) – quantile of flux values at which to clip when extracting values
along an isophote. Clipping outlier values (such as very bright
stars) while fitting isophotes allows for robust computation of
FFT coefficients along an isophote.</p></li>
<li><p><strong>ap_isofit_losscoefs</strong> (<em>tuple</em><em>, </em><em>default</em><em> (</em><em>2</em><em>,</em><em>)</em>) – Tuple of FFT coefficients to use in optimization
procedure. AutoProf will attemp to minimize the power in all
listed FFT coefficients. Must be a tuple, not a list.</p></li>
<li><p><strong>ap_isofit_superellipse</strong> (<em>bool</em><em>, </em><em>default False</em>) – If True, AutoProf will fit superellipses instead of regular
ellipses. A superellipse is typically used to represent
boxy/disky isophotes. The variable controlling the transition
from a rectangle to an ellipse to a four-armed-star like shape
is C. A value of C = 2 represents an ellipse and is the starting
point of the optimization.</p></li>
<li><p><strong>ap_isofit_fitcoefs</strong> (<em>tuple</em><em>, </em><em>default None</em>) – Tuple of FFT coefficients to use in fitting procedure. AutoProf
will attemp to fit ellipses with these Fourier mode
perturbations. Such perturbations allow for lopsided, boxy,
disky, and other types of isophotes beyond straightforward
ellipses. Must be a tuple, not a list. Note that AutoProf will
first fit ellipses, then turn on the Fourier mode perturbations,
thus the fitting time will always be longer.</p></li>
<li><p><strong>ap_isofit_fitcoefs_FFTinit</strong> (<em>bool</em><em>, </em><em>default False</em>) – If True, the coefficients for the Fourier modes fitted from
ap_isofit_fitcoefs will be initialized using an FFT
decomposition along fitted elliptical isophotes. This can
improve the fit result, though it is less stable and so users
should examine the results after fitting.</p></li>
<li><p><strong>ap_isofit_perturbscale_ellip</strong> (<em>float</em><em>, </em><em>default 0.03</em>) – Sampling scale for random adjustments to ellipticity made while
optimizing isophotes. Smaller values will converge faster, but
get stuck in local minima; larger values will escape local
minima, but takes longer to converge.</p></li>
<li><p><strong>ap_isofit_perturbscale_pa</strong> (<em>float</em><em>, </em><em>default 0.06</em>) – Sampling scale for random adjustments to position angle made
while optimizing isophotes. Smaller values will converge faster,
but get stuck in local minima; larger values will escape local
minima, but takes longer to converge.</p></li>
<li><p><strong>ap_isofit_iterlimitmax</strong> (<em>int</em><em>, </em><em>default 300</em>) – Maximum number of iterations (each iteration adjusts every
isophote once) before automatically stopping optimization. For
galaxies with lots of structure (ie detailed spiral arms) more
iterations may be needed to fully fit the light distribution,
but runtime will be longer.</p></li>
<li><p><strong>ap_isofit_iterlimitmin</strong> (<em>int</em><em>, </em><em>default 0</em>) – Minimum number of iterations before optimization is allowed to
stop.</p></li>
<li><p><strong>ap_isofit_iterstopnochange</strong> (<em>float</em><em>, </em><em>default 3</em>) – Number of iterations with no updates to parameters before
optimization procedure stops. Lower values will process galaxies
faster, but may still be stuck in local minima, higher values
are more likely to converge on the global minimum but can take a
long time to run. Fractional values are allowed though not
recomended.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘psf fwhm’</p></li>
<li><p>‘center’</p></li>
<li><p>‘mask’ (optional)</p></li>
<li><p>‘init ellip’</p></li>
<li><p>‘init pa’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;fit ellip&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of ellipticity values (ndarray)</span>
 <span class="s1">&#39;fit pa&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of PA values (ndarray)</span>
 <span class="s1">&#39;fit R&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of semi-major axis values (ndarray)</span>
 <span class="s1">&#39;fit ellip_err&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, array of ellipticity error values (ndarray)</span>
 <span class="s1">&#39;fit pa_err&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, array of PA error values (ndarray)</span>
 <span class="s1">&#39;fit C&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, superellipse scale parameter (ndarray)</span>
 <span class="s1">&#39;fit Fmodes&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, fitted Fourier mode indices (tuple)</span>
 <span class="s1">&#39;fit Fmode A*&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, fitted Fourier mode amplitudes, * for each index (ndarray)</span>
 <span class="s1">&#39;fit Fmode Phi*&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, fitted Fourier mode phases, * for each index (ndarray)</span>
 <span class="s1">&#39;auxfile fitlimit&#39;</span><span class="p">:</span> <span class="c1"># optional, auxfile message (string)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Isophote_Fit.Isophote_Fit_FFT_mean">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Isophote_Fit.</span></span><span class="sig-name descname"><span class="pre">Isophote_Fit_FFT_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Isophote_Fit.html#Isophote_Fit_FFT_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Isophote_Fit.Isophote_Fit_FFT_mean" title="Permalink to this definition"></a></dt>
<dd><p>Fit elliptical isophotes to a galaxy image using FFT coefficients and regularization.</p>
<p>Same as the standard isophote fitting routine, except uses less
robust mean/std measures. This is only intended for low S/N data
where pixels have low integer counts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_scale</strong> (<em>float</em><em>, </em><em>default 0.2</em>) – growth scale when fitting isophotes, not the same as
<em>ap_sample—scale</em>.</p></li>
<li><p><strong>ap_fit_limit</strong> (<em>float</em><em>, </em><em>default 2</em>) – noise level out to which to extend the fit in units of pixel
background noise level. Default is 2, smaller values will end
fitting further out in the galaxy image.</p></li>
<li><p><strong>ap_regularize_scale</strong> (<em>float</em><em>, </em><em>default 1</em>) – scale factor to apply to regularization coupling factor between
isophotes.  Default of 1, larger values make smoother fits,
smaller values give more chaotic fits.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘center’</p></li>
<li><p>‘psf fwhm’</p></li>
<li><p>‘init ellip’</p></li>
<li><p>‘init pa’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;fit ellip&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of ellipticity values (ndarray)</span>
 <span class="s1">&#39;fit pa&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of PA values (ndarray)</span>
 <span class="s1">&#39;fit R&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of semi-major axis values (ndarray)</span>
 <span class="s1">&#39;fit ellip_err&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, array of ellipticity error values (ndarray)</span>
 <span class="s1">&#39;fit pa_err&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, array of PA error values (ndarray)</span>
 <span class="s1">&#39;auxfile fitlimit&#39;</span><span class="p">:</span> <span class="c1"># optional, auxfile message (string)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Isophote_Fit.Isophote_Fit_FixedPhase">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Isophote_Fit.</span></span><span class="sig-name descname"><span class="pre">Isophote_Fit_FixedPhase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Isophote_Fit.html#Isophote_Fit_FixedPhase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Isophote_Fit.Isophote_Fit_FixedPhase" title="Permalink to this definition"></a></dt>
<dd><p>Simply applies fixed position angle and ellipticity at the initialization values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_scale</strong> (<em>float</em><em>, </em><em>default 0.2</em>) – growth scale when fitting isophotes, not the same as
<em>ap_sample—scale</em>.</p></li>
<li><p><strong>ap_fit_limit</strong> (<em>float</em><em>, </em><em>default 2</em>) – noise level out to which to extend the fit in units of pixel
background noise level. Default is 2, smaller values will end
fitting further out in the galaxy image.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘psf fwhm’</p></li>
<li><p>‘center’</p></li>
<li><p>‘mask’ (optional)</p></li>
<li><p>‘init ellip’</p></li>
<li><p>‘init pa’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;fit ellip&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of ellipticity values (ndarray)</span>
 <span class="s1">&#39;fit pa&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of PA values (ndarray)</span>
 <span class="s1">&#39;fit R&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of semi-major axis values (ndarray)</span>
 <span class="s1">&#39;fit ellip_err&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, array of ellipticity error values (ndarray)</span>
 <span class="s1">&#39;fit pa_err&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, array of PA error values (ndarray)</span>
 <span class="s1">&#39;auxfile fitlimit&#39;</span><span class="p">:</span> <span class="c1"># optional, auxfile message (string)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Isophote_Fit.Isophote_Fit_Forced">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Isophote_Fit.</span></span><span class="sig-name descname"><span class="pre">Isophote_Fit_Forced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Isophote_Fit.html#Isophote_Fit_Forced"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Isophote_Fit.Isophote_Fit_Forced" title="Permalink to this definition"></a></dt>
<dd><p>Read previously fit PA/ellipticity profile.</p>
<p>Reads a .prof file and extracts the corresponding PA/ellipticity profile. The profile is extracted generically, so any csv file with columns for ‘R’, ‘pa’, ‘ellip’, and optionally ‘pa_e’ and ‘ellip_e’ will be able to create a forced fit. This can be used for testing purposes, such as selecting a specific isophote to extract or comparing AutoProf SB extraction methods with other softwares.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ap_forcing_profile</strong> (<em>string</em><em>, </em><em>default None</em>) – File path to .prof file providing forced photometry PA and
ellip values to apply to <em>ap_image_file</em> (required for forced
photometry)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘center’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;fit ellip&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of ellipticity values (ndarray)</span>
 <span class="s1">&#39;fit pa&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of PA values (ndarray)</span>
 <span class="s1">&#39;fit R&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of semi-major axis values (ndarray)</span>
 <span class="s1">&#39;fit ellip_err&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, array of ellipticity error values (ndarray)</span>
 <span class="s1">&#39;fit pa_err&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, array of PA error values (ndarray)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Isophote_Fit.Photutils_Fit">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Isophote_Fit.</span></span><span class="sig-name descname"><span class="pre">Photutils_Fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Isophote_Fit.html#Photutils_Fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Isophote_Fit.Photutils_Fit" title="Permalink to this definition"></a></dt>
<dd><p>Photutils elliptical isophote wrapper.</p>
<p>This simply gives users access to the photutils isophote
fitting method. See: <a class="reference external" href="https://photutils.readthedocs.io/en/stable/isophote.html">photutils</a> for
more information.</p>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘center’</p></li>
<li><p>‘init R’</p></li>
<li><p>‘init ellip’</p></li>
<li><p>‘init pa’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;fit ellip&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of ellipticity values (ndarray)</span>
 <span class="s1">&#39;fit pa&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of PA values (ndarray)</span>
 <span class="s1">&#39;fit R&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># array of semi-major axis values (ndarray)</span>
 <span class="s1">&#39;fit ellip_err&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, array of ellipticity error values (ndarray)</span>
 <span class="s1">&#39;fit pa_err&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># optional, array of PA error values (ndarray)</span>
 <span class="s1">&#39;auxfile fitlimit&#39;</span><span class="p">:</span> <span class="c1"># optional, auxfile message (string)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.Isophote_Initialize">
<span id="pipeline-steps-isophote-initialize-module"></span><h2>pipeline_steps.Isophote_Initialize module<a class="headerlink" href="#module-autoprof.pipeline_steps.Isophote_Initialize" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Isophote_Initialize.Isophote_Init_Forced">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Isophote_Initialize.</span></span><span class="sig-name descname"><span class="pre">Isophote_Init_Forced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Isophote_Initialize.html#Isophote_Init_Forced"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Isophote_Initialize.Isophote_Init_Forced" title="Permalink to this definition"></a></dt>
<dd><p>Read global elliptical isophote to a galaxy from an aux file.</p>
<p>Extracts global ellipse parameters from the corresponding aux file for a given .prof file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ap_forcing_profile</strong> (<em>string</em><em>, </em><em>default None</em>) – File path to .prof file providing forced photometry PA and
ellip values to apply to <em>ap_image_file</em> (required for forced
photometry)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘psf fwhm’</p></li>
<li><p>‘center’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;init ellip&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># Ellipticity of the global fit (float)</span>
 <span class="s1">&#39;init pa&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># Position angle of the global fit (float)</span>
 <span class="s1">&#39;init R&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># Semi-major axis length of global fit (float)</span>
 <span class="s1">&#39;auxfile initialize&#39;</span><span class="p">:</span> <span class="c1"># optional, message for aux file to record the global ellipticity and postition angle (string)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Isophote_Initialize.Isophote_Initialize">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Isophote_Initialize.</span></span><span class="sig-name descname"><span class="pre">Isophote_Initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Isophote_Initialize.html#Isophote_Initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Isophote_Initialize.Isophote_Initialize" title="Permalink to this definition"></a></dt>
<dd><p>Fit global elliptical isophote to a galaxy image using FFT coefficients.</p>
<p>A global position angle and ellipticity are fit in a two step
process.  First, a series of circular isophotes are geometrically
sampled until they approach the background level of the image.  An
FFT is taken for the flux values around each isophote and the
phase of the second coefficient is used to determine a direction.
The average direction for the outer isophotes is taken as the
position angle of the galaxy.  Second, with fixed position angle
the ellipticity is optimized to minimize the amplitude of the
second FFT coefficient relative to the median flux in an isophote.</p>
<p>To compute the error on position angle we use the standard
deviation of the outer values from step one.  For ellipticity the
error is computed by optimizing the ellipticity for multiple
isophotes within 1 PSF length of each other.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_fit_limit</strong> (<em>float</em><em>, </em><em>default 2</em>) – noise level out to which to extend the fit in units of pixel background noise level. Default is 2, smaller values will end fitting further out in the galaxy image.</p></li>
<li><p><strong>ap_isoinit_pa_set</strong> (<em>float</em><em>, </em><em>default None</em>) – User set initial position angle in degrees, will override the calculation.</p></li>
<li><p><strong>ap_isoinit_ellip_set</strong> (<em>float</em><em>, </em><em>default None</em>) – User set initial ellipticity (1 - b/a), will override the calculation.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘psf fwhm’</p></li>
<li><p>‘center’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;init ellip&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># Ellipticity of the global fit (float)</span>
 <span class="s1">&#39;init pa&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># Position angle of the global fit (float)</span>
 <span class="s1">&#39;init R&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># Semi-major axis length of global fit (float)</span>
 <span class="s1">&#39;auxfile initialize&#39;</span><span class="p">:</span> <span class="c1"># optional, message for aux file to record the global ellipticity and postition angle (string)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Isophote_Initialize.Isophote_Initialize_mean">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Isophote_Initialize.</span></span><span class="sig-name descname"><span class="pre">Isophote_Initialize_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Isophote_Initialize.html#Isophote_Initialize_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Isophote_Initialize.Isophote_Initialize_mean" title="Permalink to this definition"></a></dt>
<dd><p>Fit global elliptical isophote to a galaxy image using FFT coefficients.</p>
<p>Same as the default isophote initialization routine, except uses
mean/std measures for low S/N applications.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ap_fit_limit</strong> (<em>float</em><em>, </em><em>default 2</em>) – noise level out to which to extend the fit in units of pixel
background noise level. Default is 2, smaller values will end
fitting further out in the galaxy image.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘psf fwhm’</p></li>
<li><p>‘center’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;init ellip&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># Ellipticity of the global fit (float)</span>
 <span class="s1">&#39;init pa&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># Position angle of the global fit (float)</span>
 <span class="s1">&#39;init R&#39;</span><span class="p">:</span> <span class="p">,</span><span class="c1"># Semi-major axis length of global fit (float)</span>
 <span class="s1">&#39;auxfile initialize&#39;</span><span class="p">:</span> <span class="c1"># optional, message for aux file to record the global ellipticity and postition angle (string)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.Mask">
<span id="pipeline-steps-mask-module"></span><h2>pipeline_steps.Mask module<a class="headerlink" href="#module-autoprof.pipeline_steps.Mask" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Mask.Bad_Pixel_Mask">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Mask.</span></span><span class="sig-name descname"><span class="pre">Bad_Pixel_Mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Mask.html#Bad_Pixel_Mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Mask.Bad_Pixel_Mask" title="Permalink to this definition"></a></dt>
<dd><p>Simple masking routine to clip pixels based on thresholds.</p>
<p>Creates a mask image using user provided limits on highest/lowest
pixels values allowed. Also users can reject pixels with a
specific value. This can be used on its own, or in combination
with other masking routines. Multiple Mask calls with perform
boolean-or operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_badpixel_high</strong> (<em>float</em><em>, </em><em>default None</em>) – flux value that corresponds to a saturated pixel or bad pixel
flag, all values above <em>ap_badpixel_high</em> will be masked if
using the <em>Bad_Pixel_Mask</em> pipeline method.</p></li>
<li><p><strong>ap_badpixel_low</strong> (<em>float</em><em>, </em><em>default None</em>) – flux value that corresponds to a bad pixel flag, all values
below <em>ap_badpixel_low</em> will be masked if using the
<em>Bad_Pixel_Mask</em> pipeline method.</p></li>
<li><p><strong>ap_badpixel_exact</strong> (<em>float</em><em>, </em><em>default None</em>) – flux value that corresponds to a precise bad pixel flag, all
values equal to <em>ap_badpixel_exact</em> will be masked if using the
<em>Bad_Pixel_Mask</em> pipeline method.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ap_savemask</span></code></dt><dd><p>bool, default False indicates if the mask should be saved after fitting</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘mask’ (optional)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;mask&#39;</span><span class="p">:</span>  <span class="c1"># 2d mask image with boolean datatype (ndarray)</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Mask.Mask_Segmentation_Map">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Mask.</span></span><span class="sig-name descname"><span class="pre">Mask_Segmentation_Map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Mask.html#Mask_Segmentation_Map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Mask.Mask_Segmentation_Map" title="Permalink to this definition"></a></dt>
<dd><p>Reads the results from other masking routines into AutoProf.</p>
<p>Creates a mask from a supplied segmentation map. Such maps
typically number each source with an integer. In such a case,
AutoProf will check to see if the object center lands on one of
these segments, if so it will zero out that source-id before
converting the segmentation map into a mask. If the supplied image
is just a 0, 1 mask then AutoProf will take it as is.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ap_mask_file</strong> (<em>string</em><em>, </em><em>default None</em>) – path to fits file which is a mask for the image. Must have the same dimensions as the main image.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ap_savemask</span></code></dt><dd><p>bool, default False indicates if the mask should be saved after fitting</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’ (optional)</p></li>
<li><p>‘background noise’ (optional)</p></li>
<li><p>‘center’ (optional)</p></li>
<li><p>‘mask’ (optional)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;mask&#39;</span><span class="p">:</span>  <span class="c1"># 2d mask image with boolean datatype (ndarray)</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Mask.Star_Mask">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Mask.</span></span><span class="sig-name descname"><span class="pre">Star_Mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Mask.html#Star_Mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Mask.Star_Mask" title="Permalink to this definition"></a></dt>
<dd><p>Masking routine which identifies stars and masks a region around them.</p>
<p>Using an edge detecting convolutional filter, sources are
identified that are of similar scale as the PSF. These sources are
masked with a region roughly 2 times the FWHM of the source.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ap_savemask</span></code></dt><dd><p>bool, default False indicates if the mask should be saved after fitting</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">starfind</span></code></dt><dd><p><code class="xref py py-func docutils literal notranslate"><span class="pre">autoprofutils.SharedFunctions.StarFind()</span></code></p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘psf fwhm’</p></li>
<li><p>‘center’</p></li>
<li><p>‘mask’ (optional)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;mask&#39;</span><span class="p">:</span>  <span class="c1"># 2d mask image with boolean datatype (ndarray)</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Mask.Star_Mask_IRAF">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Mask.</span></span><span class="sig-name descname"><span class="pre">Star_Mask_IRAF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Mask.html#Star_Mask_IRAF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Mask.Star_Mask_IRAF" title="Permalink to this definition"></a></dt>
<dd><p>Masking routine which identifies stars and masks a region around them.</p>
<p>An IRAF star finder wrapper (from photutils) is applied to the
image and then the identified sources are masked form the image.
The size of the mask depends on the flux in the source roughly as
sqrt(log(f)), thus an inverse of a Gaussian.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ap_savemask</span></code></dt><dd><p>bool, default False indicates if the mask should be saved after fitting</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘psf fwhm’</p></li>
<li><p>‘center’</p></li>
<li><p>‘mask’ (optional)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;mask&#39;</span><span class="p">:</span>  <span class="c1"># 2d mask image with boolean datatype (ndarray)</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.PSF">
<span id="pipeline-steps-psf-module"></span><h2>pipeline_steps.PSF module<a class="headerlink" href="#module-autoprof.pipeline_steps.PSF" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.PSF.PSF_IRAF">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.PSF.</span></span><span class="sig-name descname"><span class="pre">PSF_IRAF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/PSF.html#PSF_IRAF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.PSF.PSF_IRAF" title="Permalink to this definition"></a></dt>
<dd><p>PSF routine which identifies stars and averages the FWHM.</p>
<p>Uses the photutil IRAF wrapper to identify stars in the image and
computes the average FWHM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_guess_psf</strong> (<em>float</em><em>, </em><em>default None</em>) – Initialization value for the PSF calculation in pixels. If not
given, AutoProf will default with a guess of 1/<em>ap_pixscale</em></p></li>
<li><p><strong>ap_set_psf</strong> (<em>float</em><em>, </em><em>default None</em>) – force AutoProf to use this PSF value (in pixels) instead of
calculating its own.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’ (float)</p></li>
<li><p>‘background noise’ (float)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;psf fwhm&#39;</span><span class="p">:</span>  <span class="c1"># FWHM of the average PSF for the image</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.PSF.PSF_Image">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.PSF.</span></span><span class="sig-name descname"><span class="pre">PSF_Image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/PSF.html#PSF_Image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.PSF.PSF_Image" title="Permalink to this definition"></a></dt>
<dd><p>PSF routine which identifies stars and averages the FWHM.</p>
<p>Constructs an averaged PSF image. Extracts a window of pixels
around each identified star (+-10 PSF) and normalizes the flux
total to 1. All extraced normalized stars are median stacked. The
final PSF is saved as “&lt;name&gt;_psf.fits” and added to the results
dictionary. Also calculates the PSF FWHM and adds it to the
results dictionary. This method is currently very slow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_guess_psf</strong> (<em>float</em><em>, </em><em>default None</em>) – Initialization value for the PSF calculation in pixels. If not
given, AutoProf will default with a guess of 1/<em>ap_pixscale</em></p></li>
<li><p><strong>ap_set_psf</strong> (<em>float</em><em>, </em><em>default None</em>) – force AutoProf to use this PSF value (in pixels) instead of
calculating its own.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;psf fwhm&#39;</span><span class="p">:</span>  <span class="c1"># FWHM of the average PSF for the image</span>
 <span class="s1">&#39;auxfile psf&#39;</span><span class="p">:</span> <span class="c1"># aux file message giving the PSF</span>
 <span class="s1">&#39;psf img&#39;</span><span class="p">:</span>   <span class="c1"># image of the PSF as numpy array</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.PSF.PSF_StarFind">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.PSF.</span></span><span class="sig-name descname"><span class="pre">PSF_StarFind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/PSF.html#PSF_StarFind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.PSF.PSF_StarFind" title="Permalink to this definition"></a></dt>
<dd><p>PSF routine which identifies stars and averages the FWHM.</p>
<p>The PSF method uses an edge finding convolution filter to identify
candidate star pixels, then averages their FWHM. Randomly iterates
through the pixels and searches for a local maximum. An FFT is
used to identify non-circular star candidate (artifacts or
galaxies) which may have been picked up by the edge
finder. Circular apertures are placed around the star until half
the central flux value is reached, This is recorded as the FWHM
for that star. A collection of 50 stars are identified and the
most circular (by FFT coefficients) half are kept, a median is
taken as the image PSF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_guess_psf</strong> (<em>float</em><em>, </em><em>default None</em>) – Initialization value for the PSF calculation in pixels. If not
given, AutoProf will default with a guess of 1/<em>ap_pixscale</em></p></li>
<li><p><strong>ap_set_psf</strong> (<em>float</em><em>, </em><em>default None</em>) – force AutoProf to use this PSF value (in pixels) instead of
calculating its own.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;psf fwhm&#39;</span><span class="p">:</span>  <span class="c1"># FWHM of the average PSF for the image</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.PSF.PSF_deconvolve">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.PSF.</span></span><span class="sig-name descname"><span class="pre">PSF_deconvolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/PSF.html#PSF_deconvolve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.PSF.PSF_deconvolve" title="Permalink to this definition"></a></dt>
<dd><p>routine which deconvolves the PSF from the primary image.</p>
<p>Performs Richardson-Lucy deconvolution on the primary galaxy image
using the sci-kit image implementation (the user must have skimage
in their python installation). This deconvolution procedure is
more stable than standard FFT deconvolution. This method is
currently very slow. If the user provides an image via
‘ap_psf_file’ then that will be taken as the psf and deconvolved
from the image. If there is no file given, but ‘psf img’ exists in
the results dictionary (ie from the ‘psf img’ pipeline step) then
that will be used. If no other option is available, the ‘psf fwhm’
will be taken from the results dictionary and a PSF image will be
constructed using a Gaussian of the given PSF out to 20 times the
PSF size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_psf_file</strong> (<em>string</em><em>, </em><em>default None</em>) – Optional argument. Path to PSF fits file. For best results the
image should have an odd number of pixels with the PSF centered
in the image.</p></li>
<li><p><strong>ap_psf_deconvolution_iterations</strong> (<em>int</em><em>, </em><em>default 50</em>) – number of itterations of the Richardson-Lucy deconvolution
algorithm to perform.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘psf img’ (optional)</p></li>
<li><p>‘psf fwhm’ (optional)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – deconvolved galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.Plotting_Steps">
<span id="pipeline-steps-plotting-steps-module"></span><h2>pipeline_steps.Plotting_Steps module<a class="headerlink" href="#module-autoprof.pipeline_steps.Plotting_Steps" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Plotting_Steps.Plot_Galaxy_Image">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Plotting_Steps.</span></span><span class="sig-name descname"><span class="pre">Plot_Galaxy_Image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Plotting_Steps.html#Plot_Galaxy_Image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Plotting_Steps.Plot_Galaxy_Image" title="Permalink to this definition"></a></dt>
<dd><p>Generate a plain image of the galaxy</p>
<p>Plots an LSB image of the object without anything else drawn above
it.  Useful for inspecting images for spurious features. This step
can be run at any point in the pipeline. It will take advantage of
whatever information has been determined so far. So if it is the
first pipeline step, it has little to work from and will simply
plot the whole image, if it is run after the isophote
initialization step then the plotted image will be cropped to
focus on the galaxy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_guess_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided starting point for center fitting. Center should
be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
<li><p><strong>ap_set_center</strong> (<em>dict</em><em>, </em><em>default None</em>) – <p>user provided fixed center for rest of calculations. Center
should be formatted as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>
</pre></div>
</div>
<p>, where the floats are the center coordinates in pixels. If not
given, Autoprof will default to a guess of the image center.</p>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’</p></li>
<li><p>‘background noise’</p></li>
<li><p>‘center’ (optional)</p></li>
<li><p>‘init R’ (optional)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.Radial_Profiles">
<span id="pipeline-steps-radial-profiles-module"></span><h2>pipeline_steps.Radial_Profiles module<a class="headerlink" href="#module-autoprof.pipeline_steps.Radial_Profiles" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Radial_Profiles.Radial_Profiles">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Radial_Profiles.</span></span><span class="sig-name descname"><span class="pre">Radial_Profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Radial_Profiles.html#Radial_Profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Radial_Profiles.Radial_Profiles" title="Permalink to this definition"></a></dt>
<dd><p>Extracts SB profiles along lines radiating from the galaxy center.</p>
<p>For some applications, such as examining edge on galaxies, it is
beneficial to observe the structure in a disk as well as (or
instead of) the average isophotal profile. This can done with
radial profiles which sample along lines radiating form the galaxy
center. These lines are by default placed on the 4 semi-axes of
the galaxy. The lines are actually wedges with increasing width as
a function of radius. This helps keep roughly constant S/N in the
bins, allowing the profile to extend far into the outskirts of a
galaxy. The user may increase the number of wedgest to extract
more stucture from the galaxy, however at some point the wedges
will begin to cross each other. AutoProf will warn the user when
this happens, but will carry on anyway.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_radialprofiles_nwedges</strong> (<em>int</em><em>, </em><em>default 4</em>) – number of radial wedges to sample. Recommended choosing a power
of 2.</p></li>
<li><p><strong>ap_radialprofiles_width</strong> (<em>float</em><em>, </em><em>default 15</em>) – User set width of radial sampling wedges in degrees.</p></li>
<li><p><strong>ap_radialprofiles_pa</strong> (<em>float</em><em>, </em><em>default 0</em>) – user set position angle at which to measure radial wedges
relative to the global position angle, in degrees.</p></li>
<li><p><strong>ap_radialprofiles_expwidth</strong> (<em>bool</em><em>, </em><em>default False</em>) – Tell AutoProf to use exponentially increasing widths for radial
samples. In this case <em>ap_radialprofiles_width</em> corresponds to
the final width of the radial sampling.</p></li>
<li><p><strong>ap_radialprofiles_variable_pa</strong> (<em>bool</em><em>, </em><em>default False</em>) – Tell AutoProf to rotate radial sampling wedges with the position
angle profile of the galaxy.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘prof header’ (optional)</p></li>
<li><p>‘prof units’ (optional)</p></li>
<li><p>‘prof data’ (optional)</p></li>
<li><p>‘mask’ (optional)</p></li>
<li><p>‘background’</p></li>
<li><p>‘center’</p></li>
<li><p>‘init pa’ (optional)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) – No results provided as this method writes its own profile</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;prof header&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># Previously extracted SB profile, with extra columns appended for radial profiles (list)</span>
 <span class="s1">&#39;prof units&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1"># Previously extracted SB profile, with extra units appended for radial profiles (dict)</span>
 <span class="s1">&#39;prof data&#39;</span><span class="p">:</span> <span class="c1"># Previously extracted SB profile, with extra columns appended for radial profiles (dict)</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.Slice_Profiles">
<span id="pipeline-steps-slice-profiles-module"></span><h2>pipeline_steps.Slice_Profiles module<a class="headerlink" href="#module-autoprof.pipeline_steps.Slice_Profiles" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Slice_Profiles.Slice_Profile">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Slice_Profiles.</span></span><span class="sig-name descname"><span class="pre">Slice_Profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Slice_Profiles.html#Slice_Profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Slice_Profiles.Slice_Profile" title="Permalink to this definition"></a></dt>
<dd><p>Extract a very basic SB profile along a line.</p>
<p>A line of pixels can be identified by the user in image
coordinates to extract an SB profile. Primarily intended for
diagnostic purposes, this allows users to see very specific
pixels. While this tool can be used for examining the disk
structure (such as for edge on galaxies), users will likely prefer
the more powerful
<a class="reference internal" href="#autoprof.pipeline_steps.Axial_Profiles.Axial_Profiles" title="autoprof.pipeline_steps.Axial_Profiles.Axial_Profiles"><code class="xref py py-func docutils literal notranslate"><span class="pre">Axial_Profiles()</span></code></a> and
<a class="reference internal" href="#autoprof.pipeline_steps.Radial_Profiles.Radial_Profiles" title="autoprof.pipeline_steps.Radial_Profiles.Radial_Profiles"><code class="xref py py-func docutils literal notranslate"><span class="pre">Radial_Profiles()</span></code></a> methods
for such analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_slice_anchor</strong> (<em>dict</em><em>, </em><em>default None</em>) – Coordinates for the starting point of the slice as a dictionary
formatted “{‘x’: x-coord, ‘y’: y-coord}” in pixel units.</p></li>
<li><p><strong>ap_slice_pa</strong> (<em>float</em><em>, </em><em>default None</em>) – Position angle of the slice in degrees, counter-clockwise
relative to the x-axis.</p></li>
<li><p><strong>ap_slice_length</strong> (<em>float</em><em>, </em><em>default None</em>) – Length of the slice from anchor point in pixel units. By
default, use init ellipse semi-major axis length</p></li>
<li><p><strong>ap_slice_width</strong> (<em>float</em><em>, </em><em>default 10</em>) – Width of the slice in pixel units.</p></li>
<li><p><strong>ap_slice_step</strong> (<em>float</em><em>, </em><em>default None</em>) – Distance between samples for the profile along the
slice. By default use the PSF.</p></li>
<li><p><strong>ap_isoaverage_method</strong> (<em>string</em><em>, </em><em>default 'median'</em>) – Select the method used to compute the averafge flux along an
isophote. Choose from ‘mean’, ‘median’, and ‘mode’.  In general,
median is fast and robust to a few outliers. Mode is slow but
robust to more outliers. Mean is fast and accurate in low S/N
regimes where fluxes take on near integer values, but not robust
to outliers. The mean should be used along with a mask to remove
spurious objects such as foreground stars or galaxies, and
should always be used with caution.</p></li>
<li><p><strong>ap_saveto</strong> (<em>string</em><em>, </em><em>default None</em>) – Directory in which to save profile</p></li>
<li><p><strong>ap_name</strong> (<em>string</em><em>, </em><em>default None</em>) – Name of the current galaxy, used for making filenames.</p></li>
<li><p><strong>ap_zeropoint</strong> (<em>float</em><em>, </em><em>default 22.5</em>) – Photometric zero point. For converting flux to mag units.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘background’ (optional)</p></li>
<li><p>‘background noise’ (optional)</p></li>
<li><p>‘center’ (optional)</p></li>
<li><p>‘init R’ (optional)</p></li>
<li><p>‘init pa’ (optional)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.Write_Fi">
<span id="pipeline-steps-write-fi-module"></span><h2>pipeline_steps.Write_Fi module<a class="headerlink" href="#module-autoprof.pipeline_steps.Write_Fi" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Write_Fi.WriteFi">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Write_Fi.</span></span><span class="sig-name descname"><span class="pre">WriteFi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Write_Fi.html#WriteFi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Write_Fi.WriteFi" title="Permalink to this definition"></a></dt>
<dd><p>Writes the galaxy image to disk.</p>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps.Write_Prof">
<span id="pipeline-steps-write-prof-module"></span><h2>pipeline_steps.Write_Prof module<a class="headerlink" href="#module-autoprof.pipeline_steps.Write_Prof" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="autoprof.pipeline_steps.Write_Prof.WriteProf">
<span class="sig-prename descclassname"><span class="pre">autoprof.pipeline_steps.Write_Prof.</span></span><span class="sig-name descname"><span class="pre">WriteProf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IMG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/autoprof/pipeline_steps/Write_Prof.html#WriteProf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#autoprof.pipeline_steps.Write_Prof.WriteProf" title="Permalink to this definition"></a></dt>
<dd><p>Basic method to write SB profile to disk.</p>
<p>This step writes the results of the AutoProf pipeline analysis to
a file. There are two files written, a .prof file containing the
surface brightness profile and acompanying measurements, and a
.aux file containing global results, messages, and setting used
for the pipeline. The .prof file looks for specific keywords in
the results dictionary: prof header, prof units, prof data, and
prof format. There are the results from the isophotal fitting
step. prof header gives the column names for the profile, prof
units is a dictionary which gives the corresponding units for each
column header key, prof data is a dictionary containing a list of
values for each header key, and prof format is a dictionary which
gives the python string format for values under each header key
(for example ‘%.4f’ gives a number to 4 decimal places). The
profile is written with comma (or a user specified delimiter)
separation for each value, where each row corresponds to a given
isophote at increasing semi-major axis values.</p>
<p>The .aux file has a less strict format than the .prof file. The
first line records the date and time that the file was written,
the second line gives the name of the object as specified by the
user or the filename. The next lines are taken from the results
dictionary, any result key with auxfile in the name is taken as a
message for the .aux file and written (in alphabetical order by
key) to the file. See the pipeline step output formats for the
messages that are included in the .aux file. Finally, a record of
the user specified options is included for reference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_saveto</strong> (<em>string</em><em>, </em><em>default None</em>) – Directory in which to save profile</p></li>
<li><p><strong>ap_name</strong> (<em>string</em><em>, </em><em>default None</em>) – Name of the current galaxy, used for making filenames.</p></li>
<li><p><strong>ap_delimiter</strong> (<em>string</em><em>, </em><em>default '</em><em>,</em><em>'</em>) – Delimiter to use between entries in the profile.</p></li>
<li><p><strong>ap_profile_format</strong> (<em>string</em><em>, </em><em>default 'csv'</em>) – Type of file format to use for profile. Can choose from [‘csv’, ‘fits’]</p></li>
<li><p><strong>ap_savemask</strong> (<em>bool</em><em>, </em><em>default False</em>) – Save object mask fits file. This can create large files, depending on the size of the original image.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>‘prof header’</p></li>
<li><p>‘prof units’</p></li>
<li><p>‘prof data’</p></li>
<li><p>‘mask’ (optional)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>IMG</strong> (<em>ndarray</em>) – Unaltered galaxy image</p></li>
<li><p><strong>results</strong> (<em>dict</em>) –</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{}</span>
</pre></div>
</div>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-autoprof.pipeline_steps">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-autoprof.pipeline_steps" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="autoprofutils.html" class="btn btn-neutral float-left" title="autoprofutils package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Connor Stone.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>